# ATP Endpoints

This file documents ATP endpoints and related URL patterns (updated 2026-02-27).

## Endpoints

### Rankings
- `GET https://app.atptour.com/api/gateway/rankings.ranksglrollrange?fromRank=1&toRank=100`
- Required query params: `fromRank`, `toRank`
- Example: `https://app.atptour.com/api/gateway/rankings.ranksglrollrange?fromRank=1&toRank=100`
- Example JSON: [rankings.ranksglrollrange.1-100.example.json](./examples/rankings.ranksglrollrange.1-100.example.json)

### Player Activity
- `GET https://www.atptour.com/en/-/www/activity/last/{player}`
- Example (`{player}=S0AG`, Jannik Sinner): `https://www.atptour.com/en/-/www/activity/last/S0AG`
- Example JSON: [activity.last.S0AG.example.json](./examples/activity.last.S0AG.example.json)

### Event Results Archive
- `GET https://app.atptour.com/api/gateway/scores.resultsarchive?eventyear={eventYear}&eventid={eventID}`
- Required query params: `eventyear`, `eventid`
- Example JSON: [scores.resultsarchive.2025-336.example.json](./examples/scores.resultsarchive.2025-336.example.json)

### Player Profile
- `GET https://www.atptour.com/en/-/www/players/hero/{player}`
- Example (`{player}=S0AG`, Jannik Sinner): `https://www.atptour.com/en/-/www/players/hero/S0AG`
- Example JSON: [players.hero.S0AG.example.json](./examples/players.hero.S0AG.example.json)

### Stats Leaderboard
- `GET https://www.atptour.com/en/-/www/StatsLeaderboard/{type}/52week/all/all/false?v=1`
- Path param: `{type}` (`pressure`, `serve`, `return`)
- Example JSON: [statsleaderboard.pressure.example.json](./examples/statsleaderboard.pressure.example.json)

### Live Matches
- `GET https://app.atptour.com/api/v2/gateway/livematches/website?scoringTournamentLevel=tour`
- Query param: `scoringTournamentLevel` (commonly `tour`)
- Example JSON: [livematches.website.tour.example.json](./examples/livematches.website.tour.example.json)

### Masters 1000 Tournament Explorer
- `GET https://www.atptour.com/-/tournaments/explore/1000`
- Example JSON: [tournaments.explore.1000.example.json](./examples/tournaments.explore.1000.example.json)

### Tournament Calendar
- `GET https://www.atptour.com/en/-/tournaments/calendar/tour`
- Returns ATP Tour calendar/schedule data
- Example JSON: [tournaments.calendar.tour.example.json](./examples/tournaments.calendar.tour.example.json)

### Country Flag Asset
- `GET https://www.atptour.com/en/~/media/images/flags/{COUNTRY}.svg`
- `{COUNTRY}` format: 3-letter uppercase country code (e.g. `SWE`, `USA`, `SRB`)
- Returns SVG, not JSON
- Example JSON (request/URL pattern): [flags.country.request.example.json](./examples/flags.country.request.example.json)

## Derived ATP URL Patterns

- `https://www.atptour.com{ScRelativeUrlPlayerProfile}`
- `http://atptour.com{TournamentUrl}`

## Common Request Headers

- `Referer: https://app.atptour.com/`
- `Origin: https://app.atptour.com`

## Fetch Examples

Note: The code examples below were generated by AI and have not been verified against live endpoints in this environment.

### Node (Built-in `fetch`)
Requires Node 18+.

```js
const url = 'https://www.atptour.com/en/-/www/activity/last/S0AG';

const controller = new AbortController();
const timeout = setTimeout(() => controller.abort(), 30000);

try {
	const response = await fetch(url, {
		method: 'GET',
		headers: {
			'User-Agent': 'Mozilla/5.0',
			Accept: 'application/json, text/plain, */*',
			Referer: 'https://app.atptour.com/',
			Origin: 'https://app.atptour.com'
		},
		signal: controller.signal
	});

	if (!response.ok) {
		throw new Error(`HTTP ${response.status}`);
	}

	const contentType = response.headers.get('content-type') || '';
	if (!contentType.includes('application/json')) {
		throw new Error(`Expected JSON, got: ${contentType}`);
	}

	const data = await response.json();
	console.log(data);
} finally {
	clearTimeout(timeout);
}
```

### Python (`requests`)
Requires Python 3 and `requests` (`pip install requests`).

```python
import requests

url = "https://www.atptour.com/en/-/www/activity/last/S0AG"
headers = {
    "User-Agent": "Mozilla/5.0",
    "Accept": "application/json, text/plain, */*",
    "Referer": "https://app.atptour.com/",
    "Origin": "https://app.atptour.com",
}

response = requests.get(url, headers=headers, timeout=30)
response.raise_for_status()

content_type = response.headers.get("content-type", "")
if "application/json" not in content_type:
    raise RuntimeError(f"Expected JSON, got: {content_type}")

data = response.json()
print(data)
```
